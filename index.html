<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta name=monetization content=$ilp.uphold.com/2kD7NjJBDjBb><style>body{margin:0;text-align:center;background:#000}body,canvas{touch-action:none;user-select:none}</style><canvas id=c></canvas><script>(()=>{var e={},t=t=>e[t]||0,i=t=>delete e[t];addEventListener("keydown",(t=>{t.preventDefault(),t.repeat||(e[t.code]=performance.now())})),addEventListener("keyup",(e=>i(e.code)));var a=(...e)=>Math.max(...e.map((e=>t(e)))),n=()=>Object.keys(e).filter((e=>t(e))),o=()=>n().length,l=e=>!!t(e)&&i(e),h=(e,t,i)=>Math.max(t,Math.min(e,i));function r(e,t,i){return 0>i?e:i>1?t:e*(1-i)+t*i}function s(e){return new Promise((t=>{var i=new Image;i.onload=()=>{t(i)},i.src=e}))}var d=0,w=0,g=0,y=0,m=0,f=0,v=0,x=0,p=0,u={pageX:0,pageY:0};addEventListener("pointerdown",(e=>{e.preventDefault(),u=e,p=performance.now(),[d,w]=[v,x]=[m,f]=M()})),addEventListener("pointermove",(e=>{e.preventDefault(),u=e,[d,w]=M(),p&&(d>v?g=r(0,1,((v=d)-m)/30):m>d?g=-r(0,1,(v-(m=d))/30):v>d&&g>=0?(m=d,g=0):d>m&&0>=g&&(v=d,g=0),w>x?y=r(0,1,((x=w)-f)/30):f>w?y=-r(0,1,(x-(f=w))/30):x>w&&y>=0?(f=w,y=0):w>f&&0>=y&&(x=w,y=0))})),addEventListener("pointerup",(e=>{e.preventDefault(),u=e,p=0,g=y=m=f=v=x=0}));var b,k,A,M=()=>[Math.floor(u.pageX),Math.floor(u.pageY)],R=()=>p,E=()=>!!R()&&(p=0,!0),P=/iPhone|iPad|Android/i.test(navigator.userAgent);function X(e,t,i,a=0,n=1){const o=8*n,l=e.length*o+(e.length-1)*n,h=2===a?l:1===a?l/2:0;[...e].forEach(((e,a)=>{A.drawImage(b,8*"abcdefghijklmnopqrstuvwxyz0123456789.:!-%,/".indexOf(e),0,8,8,t+a*n*9-h,i,o,o)}))}new(window.AudioContext||webkitAudioContext);var S,Y,I,D,T,L,N=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","KeyB","KeyA"],U=0,K=0,j=["scout","tank"],F=0,B=0,Q=320,O=240,C=100,Z=c.getContext("2d"),z=c.cloneNode(),G=z.getContext("2d");z.width=640,z.height=480;var W=c.cloneNode(),H=W.getContext("2d");W.width=640,W.height=480;var V,q,J,$,ee,te=(V=c,(k=V.cloneNode()).width=320,k.height=240,(A=k.getContext("2d")).imageSmoothingEnabled=!1,k),ie={hero:{attackRate:.1,hitPoints:100,speed:75,w:10,h:10},AI:{angle:0,hitPoints:10,speed:Math.PI,w:10,h:10},bullet:{damage:1,speed:400,ttl:1/0,w:1,h:10},blast:{speed:400,maxRadius:400,w:20},scout:{damage:2,hitPoints:1,speed:110,w:10,h:10},tank:{damage:10,hitPoints:10,speed:55,w:40,h:40}},ae=!0;function ne(e){E(),n().forEach(l),K=e}function oe(e,t){const i={left:e.x-(t.x+t.w),right:e.x+e.w-t.x,top:e.y-(t.y+t.h),bottom:e.y+e.h-t.y,entity1MaxX:e.x+e.w,entity1MaxY:e.y+e.h,entity2MaxX:t.x+t.w,entity2MaxY:t.y+t.h};return i.collide=0>i.left&&i.right>0&&0>i.top&&i.bottom>0,i}function le(e,t,i,a){const n=Math.sqrt(Math.pow(i-e,2)+Math.pow(a-t,2)),o=i-e,l=a-t;return[o/n,l/n,Math.atan2(l/n,o/n)]}function he(e,t=0,i=0){return{...ie[e],moveDown:0,moveLeft:0,moveRight:0,moveUp:0,velX:0,velY:0,type:e,x:t,y:i}}function re(e){const t=e.x+e.w/2,i=e.y+e.h/2,a=S.x+S.w/2,n=S.y+S.h/2;[e.velX,e.velY,_]=le(t,i,a,n)}function ce(e){if(e.velX||e.velY){const t=e.speed*J*(e.velX&&e.velY?.7071067811865476:1);e.x+=t*e.velX,e.y+=t*e.velY}e.maxRadius&&(e.radius+=e.speed*J),e===Y&&(e.angle+=e.speed*J,e.angle%=2*Math.PI)}function se(e){q>e.invincibleEndTime&&(e.invincible=!1,e.hitPoints>0||(e.ttl=-1,e===S&&ne(2))),e.radius>e.maxRadius&&(e.ttl=-1,D=0),e!==Y||Y.hitPoints>0||(e.ttl=-1)}function de(){ae&&(ee=requestAnimationFrame(de),q=performance.now(),J=(q-$)/1e3,(()=>{switch(K){case 0:l(N[U])&&U++,(o()||E())&&(U=0,F=B=0,S=he("hero",160,120),Y={type:"AI",...ie.AI},L=!0,I={x:0,y:0},D=0,T=[S,Y,he("scout",Q/6,8),he("scout",Q/3,8),he("tank",160,16),he("scout",640/3,8),he("scout",1600/6,8)],H.fillStyle="#ccc",H.fillRect(0,0,W.width,W.height),H.fillStyle="#777",[0,2,4,6,8,10].forEach((e=>{[0,2,4,6,8,10].forEach((t=>{H.fillRect(64*e,48*t,64,48),H.fillRect(64*(e+1),48*(t+1),64,48)}))})),ne(1));break;case 1:[I.x,I.y]=(()=>{const[e,t]=(i=c.width,a=c.height,[h((u.x||u.pageX)-(innerWidth-i)/2,0,i),h(u.y||u.pageY,0,a)].map(Math.round));var i,a;return[e*Q/c.width+F,t*O/c.height+B].map(Math.round)})(),S.attacking=R(),S.moveLeft=a("ArrowLeft","KeyA","KeyQ"),S.moveRight=a("ArrowRight","KeyD"),S.moveUp=a("ArrowUp","KeyW","KeyZ"),S.moveDown=a("ArrowDown","KeyS"),S.velX=S.moveLeft||S.moveRight?(S.moveLeft>S.moveRight?-1:1)*r(0,1,(q-Math.max(S.moveLeft,S.moveRight))/150):0,S.velY=S.moveDown||S.moveUp?(S.moveUp>S.moveDown?-1:1)*r(0,1,(q-Math.max(S.moveUp,S.moveDown))/150):0,(()=>{const e=S.x+S.w/2,t=S.y+S.h/2,[i,a,n]=le(e,t,I.x,I.y);if(S.gunAngle=n,S.attacking){if(S.attackTime||=S.attackRate,S.attackTime+=J,S.attackTime>S.attackRate){S.attackTime%=S.attackRate;const[o,l]=((e,t,i,a)=>[e+i*Math.cos(a),t+i*Math.sin(a)])(e,t,S.w,n);T.unshift({...he("bullet",o,l),angle:n,velX:i,velY:a})}}else S.attackTime=0})(),T.forEach(ce),enemies=T.filter((e=>j.includes(e.type))),enemies.forEach(re),bullets=T.filter((e=>"bullet"===e.type)),t=bullets,i=enemies,t.forEach((e=>{e.ttl>0&&i.find((t=>{if(!t.invincible&&oe(e,t).collide)return t.hitPoints-=e.damage,t.invincible=!0,t.invincibleEndTime=q+250,e.ttl=-1,!0}))})),D&&enemies.forEach((e=>{D.radius>Math.sqrt(Math.pow(e.x+e.w/2-D.x,2)+Math.pow(e.y+e.h/2-D.y,2))&&(e.hitPoints=0,e.invincible||=!0,e.invincibleEndTime||=q+250)})),(e=>{S.invincible||e.find((e=>{if(oe(e,S).collide)return L?Y.hitPoints-=e.damage:S.hitPoints-=e.damage,S.invincible=!0,S.invincibleEndTime=q+250,D||(D={type:"blast",...ie.blast,radius:S.w,x:S.x+S.w/2,y:S.y+S.h/2},T.unshift(D)),!0}))})(enemies);const n=[...enemies,S];n.forEach(((e,t)=>{n.slice(t+1).forEach((t=>{const i=oe(e,t);i.collide&&((e,t,i)=>{const{entity1MaxX:a,entity1MaxY:n,entity2MaxX:o,entity2MaxY:l}=i,h=a-t.x,r=n-t.y,c=o-e.x,s=l-e.y;e.velX>0&&e.velY>0?r>h?(e.x-=h/2,t.x+=h/2):(e.y-=r/2,t.y+=r/2):e.velX>0&&0>e.velY?s>h?(e.x-=h/2,t.x+=h/2):(e.y+=s/2,t.y-=s/2):e.velX>0?(e.x-=h/2,t.x+=h/2):0>e.velX&&e.velY>0?r>c?(e.x+=c/2,t.x-=c/2):(e.y-=r/2,t.y+=r/2):0>e.velX&&0>e.velY?s>c?(e.x+=c/2,t.x-=c/2):(e.y+=s/2,t.y-=s/2):0>e.velX?(e.x+=c/2,t.x-=c/2):e.velY>0?(e.y-=r/2,t.y+=r/2):0>e.velY&&(e.y+=s/2,t.y-=s/2)})(e,t,i)}))})),0>(e=S).x?e.x=0:e.x>W.width-e.w&&(e.x=W.width-e.w),0>e.y?e.y=0:e.y>W.height-e.h&&(e.y=W.height-e.h),T.forEach(se),F>0&&F+C>S.x?F=Math.max(0,S.x-C):W.width>F+C+120&&S.x+S.w>F+C+120&&(F=Math.min(W.width-Q,S.x+S.w-220)),B>0&&B+50>S.y?B=Math.max(0,S.y-50):W.height>B+50+140&&S.y+S.h>B+50+140&&(B=Math.min(W.height-O,S.y+S.h-190)),T=T.filter((e=>!e.ttl||e.ttl>q));break;case 2:l("KeyT")&&(async e=>{if(navigator.canShare&&navigator.canShare(e))try{await navigator.share(e)}catch{}else open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(e.text)}&url=${encodeURIComponent(e.url)}`,"_blank")})({title:document.title,text:"Check this game template made by @herebefrogs",url:"https://bit.ly/gmjblp"}),(o()||E())&&ne(0)}var e,t,i})(),(()=>{switch(A.clearRect(0,0,k.width,k.height),K){case 0:G.fillStyle="#fff",G.fillRect(0,0,z.width,z.height),X("title screen",8,8),X(P?"tap to start":"press any key",160,120,1),U===N.length&&X("konami mode on",z.width-8,8,2);break;case 1:G.drawImage(W,0,0,z.width,z.height),T.forEach((e=>((e,t=G)=>{switch(t.save(),e.type){case"hero":t.translate(e.x,e.y),0>e.gunAngle?(t.save(),t.translate(e.w/2,e.h/2),t.rotate(e.gunAngle),t.translate(e.w/4,0),t.fillStyle="#ee1",t.fillRect(0,-2,10,4),t.restore(),t.fillStyle=e.hitPoints?e.invincible?"#ee1":"#1e1":"#e11",t.fillRect(0,0,e.w,e.h)):(t.fillStyle=e.hitPoints?e.invincible?"#ee1":"#1e1":"#e11",t.fillRect(0,0,e.w,e.h),t.save(),t.translate(e.w/2,e.h/2),t.rotate(e.gunAngle),t.translate(e.w/4,0),t.fillStyle="#ee1",t.fillRect(0,-2,10,4),t.restore());case"AI":t.translate(S.x+S.w/2,S.y+S.h/2),t.rotate(e.angle),t.translate(2.5*e.w,0),t.rotate(-e.angle),t.fillStyle="#1ee",t.fillRect(-e.w/2,-e.h/2,e.w,e.h);break;case"bullet":t.translate(e.x,e.y),t.rotate(e.angle+Math.PI/2),t.fillStyle="#e1e",t.fillRect(0,0,e.w,e.h);break;case"blast":t.beginPath(),t.lineWidth=e.w,t.arc(e.x,e.y,e.radius-e.w/2,0,2*Math.PI),t.strokeStyle="#1ee",t.stroke(),t.closePath();break;case"scout":case"tank":t.fillStyle=e.hitPoints?e.invincible?"#ee1":"#11e":"#e11",t.fillRect(e.x,e.y,e.w,e.h);break;case"text":((e,t,i,a,n,o=0,l=1)=>{X(e.substring(0,Math.floor(r(0,e.length,(n-a)/500))),t,i,o,l)})(e.text,e.x,e.y,e.startTime,q,e.align,e.scale)}t.restore()})(e))),(()=>{G.strokeStyle="#fff",G.lineWidth=2;const e=S.attacking?10:12,t=S.attacking?5:6;G.strokeRect(I.x-1,I.y-1,2,2),G.strokeRect(I.x-t,I.y-t,e,e)})();break;case 2:G.fillStyle="#fff",G.fillRect(0,0,z.width,z.height),X("end screen",8,8)}Z.drawImage(z,F,B,Q,O,0,0,c.width,c.height),Z.drawImage(te,0,0,Q,O,0,0,c.width,c.height)})(),$=q)}function we(e){(ae=e)?($=performance.now(),de()):cancelAnimationFrame(ee)}onload=async()=>{document.title="Stand By Me",onresize(),await(async()=>{b=await s("data:image/webp;base64,UklGRngBAABXRUJQVlA4TGwBAAAvV8EBEB8gFkz258+bhkAgiWF/1wkEKAr/L5v/APCvBpIbwI0jiYD/0n9D4RzKZze0EtD672FnsP8Ngdyjj58hNIFh2ZtCRP8Vtm3bOED3UJ1eERFttqgREbO1GQQQS+Jca1QaDwpGnBHXek3SGi0ZiKOKiOS+1ykiE0al8gXudIFjgbt3hdJ4Ep0ErBMN1BXWC3OkRhF58Q85zJn/+T/RPjuUJ4IdxhW2mu944p2YTGRbRpntp23LxmRPIn96wL69T4OR7MSV9+Mr+g77pvjQathhF4OFXX7Bsz1K16GjDIXhpHBLuUER/vfED/tmKzn49W963N9hl/2yr+ydbepfYNuSZdeeWwu7zQXY28P7nPO8Q2GDsgZjAj/kZN2TbxR8Xi3b2cFjK1jcT5YcORVO8q5eO+VmlE5yP3sXdKRjyfRpKEvEf4/Fpc2TgyofNGvMiMNBco2Yed81rsTFPzgy6rVd67Hkjkh7vUoT")})(),await s("data:image/webp;base64,UklGRvoAAABXRUJQVlA4TO0AAAAvT0AEEDegkI0kaD+kdVj40zgoxYwkQfMfg2v9l2M9lkVNACQMNCEIOPq3MIcHQbZNzcZ+sgcAlZ/5PdWeeOv2wFEjSY40hsA6AKNGsFJJ/T/DYLQIHH8MN129s4cgov8M3LaNw7a7txjZL8LDMf4r1rB0GSKbF4K5y4uBYq1A7jI7NNPSPhx6rQhN3S6ELpWd5FLH6IMjN7si35Udo6HZUgsM1NDha+wM4Efs2i4OQugUTtuccnZpNrxcDsoNs07A9qEHl7O/h4PmDm65el34+cPABatIskq6UUQaaUtaABHLKZAohglQpAV4vgkA"),we(!0)},onresize=onrotate=()=>{scaleToFit=Math.min(innerWidth/z.width,innerHeight/z.height),c.width=z.width*scaleToFit,c.height=z.height*scaleToFit,Z.imageSmoothingEnabled=H.imageSmoothingEnabled=G.imageSmoothingEnabled=!1,window.focus()},document.onvisibilitychange=e=>{we(!e.target.hidden)},addEventListener("keydown",(e=>{e.repeat||1!==K||"KeyP"!==e.code||we(!ae)}))})();</script>